<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Пример 1503-2</title>

	<script src="suica.min.js"></script>

	<script>
		
		function main()
		{
			p = new Suica();
			p.gl.canvas.addEventListener('mousedown',mouseDown,false);
			p.gl.canvas.addEventListener('contextmenu',contextMenu,false);

			orthographic(-2,2);
			lookAt([0,0,1],[0,0,0],[0,1,0]);

			k = 0;
		}
		
		function contextMenu(event)
		{
			event.preventDefault();
		}

		function mouseXY(event)
		{
			var x = event.clientX-event.target.offsetLeft-event.target.offsetWidth/2;
			var y = -(event.clientY-event.target.offsetTop-event.target.offsetHeight/2);
			return [x,y,0];
		}

				
		function mouseDown(event)
		{
			if (k > 0) 
			{
				if (k != 3)
				{
					point(mouseXY(event)).custom({color:[1,0,0], pointSize:13});
					segment(lastpos,mouseXY(event));
					lastpos = mouseXY(event);
					k += 1;
					segment(mouseXY(event),lastpos3);
				}
				else
				{
					point(mouseXY(event)).custom({color:[1,0,0], pointSize:13});
					lastpos = mouseXY(event);
					lastpos3 = mouseXY(event);
					k = 1;
				}
			}
			else
			{
				point(mouseXY(event)).custom({color:[1,0,0], pointSize:13});
				lastpos = mouseXY(event);
				lastpos3 = mouseXY(event);
				k += 1;
			}

			

		}
		
	</script>	
</head>

<body onload="main()">
	<noscript>
		Искаме JavaScript, но няма!
	</noscript>
	
	<canvas width="740" height="350" style="border: solid 1px Black;">
		Искаме canvas, но няма!
	</canvas>
</body>

</html>